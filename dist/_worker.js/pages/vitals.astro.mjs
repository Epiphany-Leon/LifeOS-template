globalThis.process ??= {}; globalThis.process.env ??= {};
import { c as createComponent, r as renderTemplate, h as renderComponent, i as createAstro, m as maybeRenderHead, k as addAttribute } from '../chunks/astro/server_29JV-YUN.mjs';
import { $ as $$Layout } from '../chunks/Layout_C5FsecMX.mjs';
import { $ as $$GlobalAlert } from '../chunks/GlobalAlert_DSyPIMTV.mjs';
/* empty css                                 */
export { renderers } from '../renderers.mjs';

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a, _b;
const $$Astro = createAstro();
const prerender = false;
const $$Index = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Index;
  const db = Astro2.locals.runtime?.env?.DB;
  let principles = [];
  let vitalsList = [];
  let theVoid = [];
  let variance = 0;
  let latestStress = 0;
  const now = /* @__PURE__ */ new Date();
  const localNow = new Date(now.getTime() - now.getTimezoneOffset() * 6e4);
  const currentMonth = localNow.toISOString().substring(0, 7);
  const exchangeRates = { CNY: 1, USD: 7.25, EUR: 7.82, GBP: 9.15, JPY: 0.048 };
  if (db) {
    try {
      const bRes = await db.prepare("SELECT amount, currency FROM monthly_budgets WHERE month = ?").bind(currentMonth).all();
      let budget = 0, displayCurrency = "CNY";
      if (bRes.results && bRes.results.length > 0) {
        budget = bRes.results[0].amount;
        displayCurrency = bRes.results[0].currency || "CNY";
      }
      const eRes = await db.prepare("SELECT amount, currency FROM expenses WHERE amount < 0 AND date LIKE ?").bind(`${currentMonth}%`).all();
      let spent = 0;
      const baseRate = exchangeRates[displayCurrency] || 1;
      (eRes.results || []).forEach((exp) => {
        const expRate = exchangeRates[exp.currency] || 1;
        spent += Math.abs(exp.amount) * expRate / baseRate;
      });
      variance = budget - spent;
    } catch (e) {
      console.error("Vitals: Budget Error");
    }
    try {
      const vRes = await db.prepare("SELECT * FROM vitals ORDER BY date DESC, id DESC LIMIT 30").all();
      vitalsList = vRes.results || [];
      if (vitalsList.length > 0) latestStress = vitalsList[0].stress_level;
    } catch (e) {
      console.error("Vitals: Journal Error");
    }
    try {
      const pRes = await db.prepare("SELECT * FROM principles ORDER BY id ASC").all();
      principles = pRes.results || [];
    } catch (e) {
      console.error("Vitals: Principles Error");
    }
    try {
      const tvRes = await db.prepare("SELECT * FROM the_void ORDER BY created_at DESC LIMIT 10").all();
      theVoid = tvRes.results || [];
    } catch (e) {
      console.error("Vitals: The Void Error");
    }
  }
  const groupedPrinciples = principles.reduce((acc, curr) => {
    const cat = curr.category || "Uncategorized";
    acc[cat] = acc[cat] || [];
    acc[cat].push(curr);
    return acc;
  }, {});
  return renderTemplate(_b || (_b = __template(["", " <script>\n  window.updatePrinciple = async (id) => {\n    const val = document.getElementById(`p-${id}`).value;\n    try { await fetch(`/api/principles/${id}`, { method: 'PUT', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ content: val }) }); } catch(err) { console.error('\u539F\u5219\u4FDD\u5B58\u5931\u8D25'); }\n  };\n  window.deletePrinciple = async (id) => {\n      if(confirm('\u5220\u9664\u8FD9\u6761\u91CD\u590D\u539F\u5219\uFF1F')) {\n          await fetch(`/api/principles/${id}`, { method: 'DELETE' });\n          setTimeout(() => window.location.reload(), 100);\n      }\n  };\n\n  document.getElementById('voidForm').addEventListener('submit', async (e) => {\n    e.preventDefault();\n    const input = document.getElementById('voidInput');\n    const content = input.value.trim();\n    if (!content) return;\n    try {\n        await fetch('/api/the_void', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ content: content }) });\n        setTimeout(() => window.location.reload(), 100); \n    } catch(err) { alert('\u4E22\u5F03\u5931\u8D25\u3002'); }\n  });\n\n  const vModal = document.getElementById('vitalsModal'), vForm = document.getElementById('vitalsForm');\n  \n  window.openVitalsModal = (id = null, reflection = '', mood = 6, stress = 30) => { \n      document.getElementById('vModalTitle').innerHTML = id ? '<span>\u270F\uFE0F</span> \u4FEE\u6539\u7075\u9B42\u89C9\u77E5' : '<span>\u{1F9D8}\u200D\u2642\uFE0F</span> \u6355\u6349\u7075\u9B42\u89C9\u77E5';\n      document.getElementById('vId').value = id || '';\n      document.getElementById('vReflection').value = reflection;\n      document.getElementById('vMood').value = mood;\n      document.getElementById('vStress').value = stress;\n      \n      vModal.classList.remove('hidden'); vModal.classList.add('flex'); void vModal.offsetWidth; \n      vModal.classList.remove('opacity-0'); vModal.querySelector('div.relative').classList.remove('scale-95'); \n      setTimeout(()=>document.getElementById('vReflection').focus(), 100); \n  };\n  \n  window.closeVitalsModal = () => { \n      vModal.classList.add('opacity-0'); vModal.querySelector('div.relative').classList.add('scale-95'); \n      setTimeout(() => { vModal.classList.add('hidden'); vModal.classList.remove('flex'); }, 300); \n  };\n\n  vForm.addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const btn = document.getElementById('vSubmitBtn');\n      btn.innerText = '\u4FDD\u5B58\u4E2D...'; btn.disabled = true;\n\n      const id = document.getElementById('vId').value;\n      \n      // \u2705 \u4FEE\u590D JavaScript \u8F6C\u6362\u5047\u503C 0 \u7684\u5E95\u5C42 Bug\n      const rawMood = parseInt(document.getElementById('vMood').value, 10);\n      const rawStress = parseInt(document.getElementById('vStress').value, 10);\n\n      const data = {\n          reflection: document.getElementById('vReflection').value,\n          mood_score: isNaN(rawMood) ? 6 : rawMood,\n          stress_level: isNaN(rawStress) ? 30 : rawStress,\n          date: new Date().toISOString().slice(0, 10)\n      };\n\n      try {\n          await fetch(id ? `/api/vitals/${id}` : '/api/vitals', { \n              method: id ? 'PUT' : 'POST', \n              headers: {'Content-Type': 'application/json'}, \n              body: JSON.stringify(data) \n          });\n          setTimeout(() => window.location.reload(), 100);\n      } catch (err) {\n          alert('\u4FDD\u5B58\u5931\u8D25\u3002');\n          btn.innerText = '\u5B9A\u683C\u8FD9\u4E00\u523B'; btn.disabled = false;\n      }\n  });\n\n  window.deleteVital = async (id) => {\n    if(confirm('\u8981\u5220\u9664\u8FD9\u6761\u89C9\u77E5\u8BB0\u5F55\u5417\uFF1F')) {\n        await fetch(`/api/vitals/${id}`, { method: 'DELETE' });\n        setTimeout(() => window.location.reload(), 100);\n    }\n  };\n\n  // AI Chatbot\n  let chatHistory = [];\n  const cModal = document.getElementById('chatModal'), cWindow = document.getElementById('chatWindow'), cInput = document.getElementById('chatInput'), cBtn = document.getElementById('chatBtn');\n  \n  window.openChatModal = () => { \n      cModal.classList.remove('hidden'); cModal.classList.add('flex'); void cModal.offsetWidth; \n      cModal.classList.remove('opacity-0'); cModal.querySelector('div.relative').classList.remove('scale-95'); \n      setTimeout(()=>cInput.focus(), 100); \n  };\n  window.closeChatModal = () => { \n      cModal.classList.add('opacity-0'); cModal.querySelector('div.relative').classList.add('scale-95'); \n      setTimeout(() => { cModal.classList.add('hidden'); cModal.classList.remove('flex'); }, 300); \n  };\n\n  function appendMsg(role, text) {\n      const isUser = role === 'user';\n      const div = document.createElement('div');\n      div.className = `flex gap-4 ${isUser ? 'w-5/6 ml-auto flex-row-reverse' : 'w-5/6'}`;\n      let innerHTML = '';\n      if(isUser) { \n          innerHTML = `<div class=\"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-white shrink-0 mt-1 shadow-md\">\u{1F464}</div><div class=\"bg-slate-800 p-4 rounded-2xl rounded-tr-none shadow-md text-white leading-relaxed font-medium break-words\">${text}</div>`; \n      } else {\n          const safeText = typeof marked !== 'undefined' ? marked.parse(text) : `<div class=\"whitespace-pre-wrap\">${text}</div>`;\n          innerHTML = `<div class=\"w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 shrink-0 mt-1 shadow-sm\">\u{1F916}</div><div class=\"bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 text-slate-700 leading-relaxed prose prose-sm prose-indigo\">${safeText}</div>`;\n      }\n      div.innerHTML = innerHTML;\n      cWindow.appendChild(div);\n      cWindow.scrollTop = cWindow.scrollHeight;\n  }\n\n  document.getElementById('chatForm').addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const text = cInput.value.trim(); if(!text) return;\n      \n      cInput.value = ''; cBtn.disabled = true; cBtn.classList.add('opacity-50');\n      appendMsg('user', text);\n      chatHistory.push({ role: 'user', content: text });\n      \n      const loadingId = 'loading-' + Date.now();\n      const loadingDiv = document.createElement('div');\n      loadingDiv.id = loadingId;\n      loadingDiv.className = 'flex gap-4 w-5/6 opacity-60';\n      loadingDiv.innerHTML = `<div class=\"w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 shrink-0 mt-1\">\u{1F916}</div><div class=\"bg-white px-5 py-4 rounded-2xl rounded-tl-none border border-slate-100 text-indigo-400 font-bold animate-pulse\">\u6B63\u5728\u8FDB\u884C\u6DF1\u5EA6\u795E\u7ECF\u5143\u89E3\u6790...</div>`;\n      cWindow.appendChild(loadingDiv); cWindow.scrollTop = cWindow.scrollHeight;\n\n      try {\n          const res = await fetch('/api/vitals/chat', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ messages: chatHistory }) });\n          const data = await res.json();\n          document.getElementById(loadingId).remove();\n          appendMsg('assistant', data.reply);\n          chatHistory.push({ role: 'assistant', content: data.reply });\n      } catch (err) {\n          document.getElementById(loadingId).remove();\n          appendMsg('assistant', '\u7F51\u7EDC\u6CE2\u52A8\u5BFC\u81F4\u8FDE\u63A5\u4E2D\u65AD\u3002');\n      }\n      cBtn.disabled = false; cBtn.classList.remove('opacity-50'); cInput.focus();\n  });\n<\/script> "], ["", " <script>\n  window.updatePrinciple = async (id) => {\n    const val = document.getElementById(\\`p-\\${id}\\`).value;\n    try { await fetch(\\`/api/principles/\\${id}\\`, { method: 'PUT', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ content: val }) }); } catch(err) { console.error('\u539F\u5219\u4FDD\u5B58\u5931\u8D25'); }\n  };\n  window.deletePrinciple = async (id) => {\n      if(confirm('\u5220\u9664\u8FD9\u6761\u91CD\u590D\u539F\u5219\uFF1F')) {\n          await fetch(\\`/api/principles/\\${id}\\`, { method: 'DELETE' });\n          setTimeout(() => window.location.reload(), 100);\n      }\n  };\n\n  document.getElementById('voidForm').addEventListener('submit', async (e) => {\n    e.preventDefault();\n    const input = document.getElementById('voidInput');\n    const content = input.value.trim();\n    if (!content) return;\n    try {\n        await fetch('/api/the_void', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ content: content }) });\n        setTimeout(() => window.location.reload(), 100); \n    } catch(err) { alert('\u4E22\u5F03\u5931\u8D25\u3002'); }\n  });\n\n  const vModal = document.getElementById('vitalsModal'), vForm = document.getElementById('vitalsForm');\n  \n  window.openVitalsModal = (id = null, reflection = '', mood = 6, stress = 30) => { \n      document.getElementById('vModalTitle').innerHTML = id ? '<span>\u270F\uFE0F</span> \u4FEE\u6539\u7075\u9B42\u89C9\u77E5' : '<span>\u{1F9D8}\u200D\u2642\uFE0F</span> \u6355\u6349\u7075\u9B42\u89C9\u77E5';\n      document.getElementById('vId').value = id || '';\n      document.getElementById('vReflection').value = reflection;\n      document.getElementById('vMood').value = mood;\n      document.getElementById('vStress').value = stress;\n      \n      vModal.classList.remove('hidden'); vModal.classList.add('flex'); void vModal.offsetWidth; \n      vModal.classList.remove('opacity-0'); vModal.querySelector('div.relative').classList.remove('scale-95'); \n      setTimeout(()=>document.getElementById('vReflection').focus(), 100); \n  };\n  \n  window.closeVitalsModal = () => { \n      vModal.classList.add('opacity-0'); vModal.querySelector('div.relative').classList.add('scale-95'); \n      setTimeout(() => { vModal.classList.add('hidden'); vModal.classList.remove('flex'); }, 300); \n  };\n\n  vForm.addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const btn = document.getElementById('vSubmitBtn');\n      btn.innerText = '\u4FDD\u5B58\u4E2D...'; btn.disabled = true;\n\n      const id = document.getElementById('vId').value;\n      \n      // \u2705 \u4FEE\u590D JavaScript \u8F6C\u6362\u5047\u503C 0 \u7684\u5E95\u5C42 Bug\n      const rawMood = parseInt(document.getElementById('vMood').value, 10);\n      const rawStress = parseInt(document.getElementById('vStress').value, 10);\n\n      const data = {\n          reflection: document.getElementById('vReflection').value,\n          mood_score: isNaN(rawMood) ? 6 : rawMood,\n          stress_level: isNaN(rawStress) ? 30 : rawStress,\n          date: new Date().toISOString().slice(0, 10)\n      };\n\n      try {\n          await fetch(id ? \\`/api/vitals/\\${id}\\` : '/api/vitals', { \n              method: id ? 'PUT' : 'POST', \n              headers: {'Content-Type': 'application/json'}, \n              body: JSON.stringify(data) \n          });\n          setTimeout(() => window.location.reload(), 100);\n      } catch (err) {\n          alert('\u4FDD\u5B58\u5931\u8D25\u3002');\n          btn.innerText = '\u5B9A\u683C\u8FD9\u4E00\u523B'; btn.disabled = false;\n      }\n  });\n\n  window.deleteVital = async (id) => {\n    if(confirm('\u8981\u5220\u9664\u8FD9\u6761\u89C9\u77E5\u8BB0\u5F55\u5417\uFF1F')) {\n        await fetch(\\`/api/vitals/\\${id}\\`, { method: 'DELETE' });\n        setTimeout(() => window.location.reload(), 100);\n    }\n  };\n\n  // AI Chatbot\n  let chatHistory = [];\n  const cModal = document.getElementById('chatModal'), cWindow = document.getElementById('chatWindow'), cInput = document.getElementById('chatInput'), cBtn = document.getElementById('chatBtn');\n  \n  window.openChatModal = () => { \n      cModal.classList.remove('hidden'); cModal.classList.add('flex'); void cModal.offsetWidth; \n      cModal.classList.remove('opacity-0'); cModal.querySelector('div.relative').classList.remove('scale-95'); \n      setTimeout(()=>cInput.focus(), 100); \n  };\n  window.closeChatModal = () => { \n      cModal.classList.add('opacity-0'); cModal.querySelector('div.relative').classList.add('scale-95'); \n      setTimeout(() => { cModal.classList.add('hidden'); cModal.classList.remove('flex'); }, 300); \n  };\n\n  function appendMsg(role, text) {\n      const isUser = role === 'user';\n      const div = document.createElement('div');\n      div.className = \\`flex gap-4 \\${isUser ? 'w-5/6 ml-auto flex-row-reverse' : 'w-5/6'}\\`;\n      let innerHTML = '';\n      if(isUser) { \n          innerHTML = \\`<div class=\"w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-white shrink-0 mt-1 shadow-md\">\u{1F464}</div><div class=\"bg-slate-800 p-4 rounded-2xl rounded-tr-none shadow-md text-white leading-relaxed font-medium break-words\">\\${text}</div>\\`; \n      } else {\n          const safeText = typeof marked !== 'undefined' ? marked.parse(text) : \\`<div class=\"whitespace-pre-wrap\">\\${text}</div>\\`;\n          innerHTML = \\`<div class=\"w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 shrink-0 mt-1 shadow-sm\">\u{1F916}</div><div class=\"bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 text-slate-700 leading-relaxed prose prose-sm prose-indigo\">\\${safeText}</div>\\`;\n      }\n      div.innerHTML = innerHTML;\n      cWindow.appendChild(div);\n      cWindow.scrollTop = cWindow.scrollHeight;\n  }\n\n  document.getElementById('chatForm').addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const text = cInput.value.trim(); if(!text) return;\n      \n      cInput.value = ''; cBtn.disabled = true; cBtn.classList.add('opacity-50');\n      appendMsg('user', text);\n      chatHistory.push({ role: 'user', content: text });\n      \n      const loadingId = 'loading-' + Date.now();\n      const loadingDiv = document.createElement('div');\n      loadingDiv.id = loadingId;\n      loadingDiv.className = 'flex gap-4 w-5/6 opacity-60';\n      loadingDiv.innerHTML = \\`<div class=\"w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 shrink-0 mt-1\">\u{1F916}</div><div class=\"bg-white px-5 py-4 rounded-2xl rounded-tl-none border border-slate-100 text-indigo-400 font-bold animate-pulse\">\u6B63\u5728\u8FDB\u884C\u6DF1\u5EA6\u795E\u7ECF\u5143\u89E3\u6790...</div>\\`;\n      cWindow.appendChild(loadingDiv); cWindow.scrollTop = cWindow.scrollHeight;\n\n      try {\n          const res = await fetch('/api/vitals/chat', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ messages: chatHistory }) });\n          const data = await res.json();\n          document.getElementById(loadingId).remove();\n          appendMsg('assistant', data.reply);\n          chatHistory.push({ role: 'assistant', content: data.reply });\n      } catch (err) {\n          document.getElementById(loadingId).remove();\n          appendMsg('assistant', '\u7F51\u7EDC\u6CE2\u52A8\u5BFC\u81F4\u8FDE\u63A5\u4E2D\u65AD\u3002');\n      }\n      cBtn.disabled = false; cBtn.classList.remove('opacity-50'); cInput.focus();\n  });\n<\/script> "])), renderComponent($$result, "Layout", $$Layout, { "title": "Vitals - \u89C9\u77E5\u4E0E\u5FC3\u667A" }, { "default": async ($$result2) => renderTemplate(_a || (_a = __template([" ", ' <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"><\/script> ', '<div class="fixed top-0 left-0 right-0 z-40 p-6 pointer-events-none"> <div class="max-w-7xl mx-auto flex justify-end"> <nav class="pointer-events-auto flex items-center gap-1 p-1.5 rounded-full bg-white/40 backdrop-blur-xl border border-white/50 shadow-lg shadow-cyan-900/5 ring-1 ring-white/60"> <a href="/" class="px-4 py-2 rounded-full text-slate-600 font-medium hover:bg-white/30 transition-all text-sm">Dashboard</a> <a href="/execution" class="px-4 py-2 rounded-full text-slate-600 font-medium hover:bg-white/30 transition-all text-sm">Execution</a> <a href="/knowledge" class="px-4 py-2 rounded-full text-slate-600 font-medium hover:bg-white/30 transition-all text-sm">Knowledge</a> <a href="/lifestyle" class="px-4 py-2 rounded-full text-slate-600 font-medium hover:bg-white/30 transition-all text-sm">Lifestyle</a> <a href="/vitals" class="px-5 py-2 rounded-full bg-white text-slate-800 font-semibold shadow-sm transition-all text-sm">Vitals</a> </nav> </div> </div> <main class="max-w-7xl mx-auto p-6 lg:p-12 pt-40 pb-32"> <header class="mb-12"> <h1 class="text-4xl font-bold text-slate-800">\u5FC3\u667A\u5F15\u64CE \xB7 <span class="text-indigo-600">Vitals</span></h1> <p class="text-slate-500 mt-2 font-medium">\u539F\u5219\u6C89\u6DC0\u3001\u89C9\u77E5\u5185\u7701\u4E0E AI \u7075\u9B42\u5BFC\u5E08\u3002</p> </header> <div class="grid grid-cols-1 lg:grid-cols-3 gap-8"> <div class="lg:col-span-1 space-y-8"> <section class="bg-white/80 backdrop-blur-xl border border-blue-100 rounded-[2.5rem] p-8 shadow-xl relative overflow-hidden"> <div class="absolute top-0 right-0 w-32 h-32 bg-blue-500/10 rounded-full blur-3xl pointer-events-none -mt-10 -mr-10"></div> <h2 class="text-xl font-black uppercase tracking-widest mb-6 text-blue-800 flex items-center gap-2"> <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>\nCore Principles\n</h2> <div class="space-y-6"> ', " ", ' </div> </section> <section class="bg-white/50 backdrop-blur-xl border border-slate-200 rounded-[2.5rem] p-8 shadow-xl"> <h2 class="text-sm font-black text-slate-400 uppercase tracking-widest mb-4">The Void (\u5FC3\u667A\u6392\u7A7A)</h2> <form id="voidForm" class="relative"> <input type="text" id="voidInput" required placeholder="\u4E22\u5F03\u60C5\u7EEA\u5783\u573E\u4E0E\u6742\u5FF5..." class="w-full bg-slate-100 border-none px-5 py-4 rounded-2xl text-sm outline-none focus:ring-2 focus:ring-slate-300 pr-12 text-slate-700"> <button type="submit" class="absolute right-2 top-2 bottom-2 aspect-square bg-slate-800 text-white rounded-xl flex items-center justify-center hover:bg-slate-700 transition"> <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg> </button> </form> <div class="mt-4 flex gap-2 flex-wrap"> ', ' </div> </section> </div> <div class="lg:col-span-2"> <section class="bg-white/60 backdrop-blur-xl border border-white p-8 rounded-[2.5rem] shadow-xl shadow-slate-200/50 min-h-full flex flex-col"> <div class="flex justify-between items-center mb-8 border-b border-slate-200/50 pb-4 shrink-0"> <h2 class="text-2xl font-black text-slate-800 flex items-center gap-3"> <span class="w-2.5 h-6 bg-indigo-500 rounded-full"></span> \u89C9\u77E5\u6D41 (Journal)\n</h2> <div class="flex items-center gap-3"> <div class="text-xs font-bold text-slate-400 bg-slate-100 px-3 py-1.5 rounded-lg">Last 30 Days</div> <button onclick="openVitalsModal()" class="px-4 py-1.5 bg-slate-800 text-white rounded-lg font-bold text-xs shadow-md hover:bg-slate-700 active:scale-95 transition-all flex items-center gap-1"> <span>+</span> \u8BB0\u5F55\u89C9\u77E5\n</button> </div> </div> <div class="space-y-6 flex-1 overflow-y-auto pr-2 custom-scrollbar"> ', " ", ' </div> </section> </div> </div> </main> <button onclick="openChatModal()" class="fixed bottom-10 right-10 z-40 w-16 h-16 bg-indigo-600 text-white rounded-full flex items-center justify-center shadow-2xl shadow-indigo-500/40 hover:scale-110 hover:bg-indigo-500 active:scale-95 transition-all group border-4 border-white"> <span class="text-2xl group-hover:animate-bounce">\u{1F916}</span> <span class="absolute -top-12 right-0 bg-slate-800 text-white text-xs font-bold px-3 py-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap shadow-lg">\u547C\u53EB\u7075\u9B42\u5BFC\u5E08</span> </button> <div id="vitalsModal" class="fixed inset-0 z-50 hidden opacity-0 transition-opacity duration-300"> <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-md cursor-pointer" onclick="closeVitalsModal()"></div> <div class="relative m-auto bg-white p-8 rounded-[2.5rem] shadow-2xl w-full max-w-lg transform scale-95 transition-transform duration-300"> <h3 id="vModalTitle" class="text-2xl font-black text-slate-800 mb-6 flex items-center gap-2"><span>\u{1F9D8}\u200D\u2642\uFE0F</span> \u6355\u6349\u7075\u9B42\u89C9\u77E5</h3> <form id="vitalsForm" class="space-y-5"> <input type="hidden" id="vId" value=""> <div> <label class="block text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">\u89C9\u77E5\u4E0E\u7075\u611F (Reflection)</label> <textarea id="vReflection" required rows="6" class="w-full px-5 py-4 rounded-2xl bg-slate-50 border border-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 text-slate-700 text-sm leading-relaxed resize-none custom-scrollbar" placeholder="\u5199\u4E0B\u4F60\u6B64\u523B\u6700\u7EAF\u7CB9\u7684\u76F4\u89C9\u3001\u53CD\u601D\u6216\u7075\u5149\u4E00\u95EA..."></textarea> </div> <div class="grid grid-cols-2 gap-4"> <div> <label class="block text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">\u5FC3\u60C5\u6253\u5206 (1-10)</label> <input type="number" id="vMood" min="1" max="10" value="6" class="w-full px-4 py-3 rounded-2xl bg-slate-50 border border-slate-100 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 text-slate-800 font-bold text-center"> </div> <div> <label class="block text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">\u538B\u529B\u6307\u6570 (1-100)</label> <input type="number" id="vStress" min="0" max="100" value="30" class="w-full px-4 py-3 rounded-2xl bg-slate-50 border border-slate-100 focus:outline-none focus:ring-2 focus:ring-rose-500/30 text-rose-600 font-bold text-center"> </div> </div> <div class="pt-2 flex justify-end gap-3"> <button type="button" onclick="closeVitalsModal()" class="px-6 py-3 rounded-full text-slate-500 font-bold hover:bg-slate-100 transition">\u53D6\u6D88</button> <button type="submit" id="vSubmitBtn" class="px-8 py-3 bg-indigo-600 text-white rounded-full font-black hover:bg-indigo-500 shadow-xl active:scale-95 transition-all">\u5B9A\u683C\u8FD9\u4E00\u523B</button> </div> </form> </div> </div> <div id="chatModal" class="fixed inset-0 z-50 hidden opacity-0 transition-opacity duration-300"> <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm cursor-pointer" onclick="closeChatModal()"></div> <div class="relative m-auto bg-white rounded-[2.5rem] shadow-2xl w-full max-w-2xl transform scale-95 transition-transform duration-300 flex flex-col h-[80vh] max-h-[800px] overflow-hidden border border-slate-200"> <div class="bg-indigo-600 p-5 text-white flex justify-between items-center shrink-0 shadow-md z-10"> <div class="flex items-center gap-3"> <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-xl">\u{1F916}</div> <div><h3 class="font-black text-lg leading-tight">\u7075\u9B42\u5BFC\u5E08</h3><p class="text-[10px] text-indigo-200 uppercase tracking-widest font-bold">DeepSeek Powered</p></div> </div> <button onclick="closeChatModal()" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> </div> <div id="chatWindow" class="flex-1 p-6 overflow-y-auto bg-slate-50 space-y-6 custom-scrollbar text-sm font-medium"> <div class="flex gap-4 w-5/6"> <div class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 shrink-0 mt-1 shadow-sm">\u{1F916}</div> <div class="bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 text-slate-700 leading-relaxed">\u4F60\u597D\uFF0CLihong\u3002\u6211\u662F\u4F60\u7684\u4E13\u5C5E\u89C9\u77E5\u5BFC\u5E08\u3002\u4F60\u7684\u539F\u5219\u548C\u8FD1\u671F\u7ECF\u5386\u6211\u90FD\u4E86\u89E3\uFF0C\u4ECA\u5929\u9700\u8981\u6211\u5E2E\u4F60\u7406\u6E05\u4EC0\u4E48\u601D\u8DEF\uFF1F</div> </div> </div> <form id="chatForm" class="p-4 bg-white border-t border-slate-100 shrink-0"> <div class="relative flex items-center"> <input type="text" id="chatInput" autocomplete="off" required placeholder="\u8F93\u5165\u4F60\u7684\u56F0\u60D1..." class="w-full bg-slate-50 border border-slate-200 rounded-full pl-5 pr-14 py-3.5 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 text-slate-800 transition"> <button type="submit" id="chatBtn" class="absolute right-1.5 w-10 h-10 bg-indigo-600 text-white rounded-full flex items-center justify-center hover:bg-indigo-500 transition active:scale-95 shadow-md shadow-indigo-200"> <svg class="w-4 h-4 ml-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg> </button> </div> </form> </div> </div> '])), renderComponent($$result2, "GlobalAlert", $$GlobalAlert, { "variance": variance, "stress": latestStress }), maybeRenderHead(), Object.keys(groupedPrinciples).map((category) => renderTemplate`<div> <h3 class="text-xs font-black text-blue-400 uppercase tracking-widest mb-3 border-b border-blue-100/50 pb-2">${category}</h3> <div class="space-y-3"> ${groupedPrinciples[category].map((p) => renderTemplate`<div class="group relative bg-slate-50 p-4 rounded-2xl border border-slate-100 hover:border-blue-200 transition shadow-sm"> <textarea${addAttribute(`p-${p.id}`, "id")} class="w-full bg-transparent resize-none outline-none font-bold text-sm text-slate-700 group-hover:text-blue-900 transition-colors custom-scrollbar" rows="2"${addAttribute(`updatePrinciple(${p.id})`, "onblur")}>${p.content}</textarea> <div class="absolute right-3 bottom-3 flex gap-2 opacity-0 group-hover:opacity-100 transition"> <span class="text-[10px] uppercase font-bold text-blue-400 pointer-events-none mt-1">Auto-save</span> <button${addAttribute(`deletePrinciple(${p.id})`, "onclick")} class="p-1 bg-white text-rose-400 border border-slate-200 rounded hover:bg-rose-50 transition" title="删除重复项"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button> </div> </div>`)} </div> </div>`), principles.length === 0 && renderTemplate`<p class="text-xs text-slate-500 italic">尚未确立原则。你需要基石来对抗混沌。</p>`, theVoid.map((v) => renderTemplate`<span class="text-[10px] px-2 py-1 bg-slate-100 text-slate-400 rounded-md line-through decoration-slate-300 truncate max-w-full block">${v.content}</span>`), vitalsList.map((v) => {
    const safeReflection = v.reflection ? String(v.reflection).replace(/'/g, "\\'").replace(/\n/g, "\\n") : "";
    return renderTemplate`<div class="group bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm hover:shadow-md transition-all relative"> <div class="flex justify-between items-start mb-3"> <div class="flex gap-2 items-center"> <div class="text-[10px] font-black uppercase tracking-widest text-indigo-400 bg-indigo-50 px-2 py-1 rounded border border-indigo-100">${v.date ? v.date.slice(0, 10) : "\u8FD1\u671F"}</div>  ${(v.mood_score != null || v.stress_level != null) && renderTemplate`<div class="text-[9px] font-bold text-slate-400"> ${v.mood_score != null ? `\u5FC3\u60C5: ${v.mood_score}` : ""} ${v.stress_level != null ? `| \u538B\u529B: ${v.stress_level}` : ""} </div>`} </div> <div class="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">  <button${addAttribute(`openVitalsModal(${v.id}, '${safeReflection}', ${v.mood_score != null ? v.mood_score : 6}, ${v.stress_level != null ? v.stress_level : 30})`, "onclick")} class="text-blue-500 p-1.5 hover:bg-blue-50 rounded-lg transition" title="修改内容"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg></button> <button${addAttribute(`deleteVital(${v.id})`, "onclick")} class="text-rose-400 p-1.5 hover:bg-rose-50 rounded-lg transition" title="删除记录"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button> </div> </div> <div class="text-sm text-slate-700 leading-relaxed font-medium whitespace-pre-wrap">${v.reflection}</div> </div>`;
  }), vitalsList.length === 0 && renderTemplate`<div class="p-12 text-center text-slate-400 border-2 border-dashed border-slate-200 rounded-[2rem] font-medium">尚未开启觉知记录。点击上方按钮开始记录。</div>`) }));
}, "/Users/admin/Documents/Private/LifeOS/src/pages/vitals/index.astro", void 0);

const $$file = "/Users/admin/Documents/Private/LifeOS/src/pages/vitals/index.astro";
const $$url = "/vitals";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Index,
  file: $$file,
  prerender,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
